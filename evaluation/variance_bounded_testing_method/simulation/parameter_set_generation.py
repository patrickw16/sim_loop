import numpy as np
import xml.etree.ElementTree as ET

def modify_xml(input_file, output_file, new_s_delta, new_v_delta):
    # Parse the XML file
    tree = ET.parse(input_file)
    root = tree.getroot()

    # Find the ParameterDeclarations
    for param in root.findall('.//ParameterDeclaration'):
        name = param.get('name')
        if name == 's_delta':
            param.set('value', str(new_s_delta))
        elif name == 'v_delta':
            param.set('value', str(new_v_delta))

    # Save the modified XML to a new file
    tree.write(output_file, encoding='utf-8', xml_declaration=True)


if __name__ == '__main__':

    parameters = np.array([[51.86871911, 15.65306467,  4.97722878],
                    [41.02525373 ,36.63296959, 5.08945089],
                    [25.7677245  ,21.89403205, 5.72568909],
                    [28.11438818 ,14.14079605, 4.34914555],
                    [36.1376003  ,26.46244354, 6.74039777],
                    [43.8570939  ,20.3005772 , 3.34503802],
                    [17.71749286 ,12.92144976, 3.2969068 ],
                    [41.11337262 ,30.00507268, 4.18269168],
                    [15.11245829 ,35.5998116 , 5.125698  ],
                    [51.88230196 ,28.50988955, 3.2808114 ],
                    [18.08416211 ,13.0777784 , 6.16856562],
                    [28.12313278 ,34.28213473, 6.8990783 ],
                    [55.12876904 ,37.68732922, 5.79312322],
                    [57.13445565 ,27.79776878, 5.58473733],
                    [53.43288878 ,16.7530951 , 6.26139403],
                    [12.46549227 ,26.0883531 , 4.96362566],
                    [21.26546498 ,28.07428688, 3.50898788],
                    [40.12064832 ,21.04981537, 5.86960341],
                    [20.17738813 ,26.12793048, 6.40423762],
                    [24.81424968 ,29.50188183, 5.06058452],
                    [52.55210418 ,35.84807568, 4.69959291],
                    [33.49779643 ,30.38109711, 5.58606849],
                    [42.07985036 ,13.93804951, 4.2312784 ],
                    [13.11078287 ,20.51437318, 3.66482307],
                    [30.10539705 ,12.89172182, 5.38126437],
                    [18.28103264 ,35.70573408, 3.65358166],
                    [42.19563902 ,12.11645049, 6.04233044],
                    [56.79364838 ,21.30482881, 3.61929748],
                    [40.19773727 ,36.58220004, 3.4682307 ],
                    [45.68657914 ,29.15907816, 5.67030331],
                    [18.65578652 ,37.40573625, 6.20278395],
                    [14.60110277 ,17.43213254, 5.149393  ],
                    [53.12438706 ,26.19404886, 6.73366505],
                    [29.13281381 ,19.48480867, 3.43702691],
                    [56.75480669 ,30.50623388, 4.21400072],
                    [49.6169031  ,24.27657867, 4.71455298],
                    [30.52798527 ,16.26338101, 6.76412483],
                    [35.9865011  ,12.74404488, 3.23565604],
                    [55.92111574 ,37.31925508, 6.88958488],
                    [30.58536501 ,36.09007235, 4.4506174 ],
                    [36.19334616 ,21.85255981, 4.67162883],
                    [23.1612816  ,22.26065971, 4.45377745],
                    [56.27430919 ,37.13532401, 3.54927117],
                    [36.54287663 ,27.51791451, 3.25195701],
                    [43.19933535 ,35.08509259, 6.69118232],
                    [13.65944055 ,31.32237785, 6.65693816],
                    [15.34319565 ,11.91729293, 4.5047763 ],
                    [34.57854133 ,38.01688135, 5.99394728],
                    [53.73997305 ,12.78804947, 3.38487839],
                    [12.84132167 ,19.95042794, 6.59707008]])
    
    # Example usage

    for idx, parameter in enumerate(parameters):

        new_s_delta = parameters[idx, 0]  # New value for s_delta
        new_v_delta = parameters[idx, 1]  # New value for v_delta
        new_a_dec = parameters[idx, 2]  # New value for a_dec

        input_file = 'scenarios/cut-in.xosc'  # Replace with your input file path
        output_file = f'scenarios/variance_bounded/{idx}_{new_a_dec}_cut-in.xosc'  # Replace with your desired output file path

        modify_xml(input_file, output_file, new_s_delta, new_v_delta)